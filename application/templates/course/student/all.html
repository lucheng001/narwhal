{% extends 'base.html' %}

{% block page_breadcrumb_1 %}课程{% endblock %}
{% block page_breadcrumb_2 %}课程列表{% endblock %}

{% block page_title_1 %}课程列表{% endblock %}
{% block page_title_2 %}Courses Table{% endblock %}

{% block page_content %}
<div class="row">
  <div class="col-md-12">
    <div class="portlet light portlet-fit bordered">
      <div class="portlet-title">
        <div class="caption">
          <i class="icon-settings font-blue-sharp"></i>
          <span class="caption-subject font-blue-sharp sbold uppercase">Courses Table</span>
        </div>
      </div>
      <div class="portlet-body">
        <div class="flip-scroll">
          {% if courses %}
          <table class="table table-hover table-striped flip-content">
            <thead class="flip-content">
              <tr>
                <th class="text-center"> # </th>
                <th> 名 称 </th>
                <th class="text-center"> 教 师 </th>
                <th class="text-center"> 开课时间 </th>
                <th class="text-center"> 结课时间 </th>
                <th class="text-center"> 状 态 </th>
                <th class="text-center"> 操 作 </th>
              </tr>
            </thead>
            <tbody>
              {% for course in courses %}
              <tr>
                <td class="text-center"> {{ loop.index }} </td>
                <td> {{ course.name }} </td>
                <td class="text-center">{{ course.creator.chineseName }}</td>
                <td class="text-center"> {{ course.createTime.strftime('%Y-%m-%d %H:%M') }} </td>
                <td class="text-center"> {{ course.endTime.strftime('%Y-%m-%d %H:%M') }} </td>
                <td class="text-center">
                  {%- if course.isEnd() -%}
                  <span class="label label-danger"> 已结束 </span>
                  {%- else -%}
                  <span class="label label-success"> 未结束 </span>
                  {%- endif -%}
                </td>
                <td class="text-center">
                  <div class="btn-group btn-group-xs btn-group-solid">
                  <button data-courseId="{{ course.id }}" class="takeCourse btn btn-outline blue" type="button">加入</button>
                  </div>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% else %}
          <div class="text-center padding-tb-20">
            <h4>暂无课程</h4>
          </div>
          {% endif %}
        </div>
        {% if pagination.page_num > 1 %}
        <div class="text-center">
          <ul class="pagination">
             {% if pagination.has_previous %}
            <li>
              <a href="{{ url_for('.all', currentPage=pagination.previous) }}">
                <i class="fa fa-angle-left"></i>
              </a>
            </li>
            {% else %}
            <li>
              <a href="javascript:;" class="disabled-link">
                <i class="fa fa-angle-left"></i>
              </a>
            </li>
            {% endif %}
            <li>
              <a href="{{ url_for('.all', currentPage=1) }}"> 首页 </a>
            </li>

            {% for page in pagination.pages %}
            <li>
              {% if page == pagination.current %}
              <a class="disabled-link font-grey-salsa" href="javascript:;"> {{ page }} </a>
              {% else %}
              <a href="{{ url_for('.all', currentPage=page) }}"> {{ page }} </a>
              {% endif %}
            </li>
            {% endfor %}

            <li>
              <a href="{{ url_for('.all', currentPage=pagination.page_num) }}"> 末页 </a>
            </li>
             {% if pagination.has_next %}
            <li>
              <a href="{{ url_for('.all', currentPage=pagination.next) }}">
                <i class="fa fa-angle-right"></i>
              </a>
            </li>
            {% else %}
            <li>
              <a href="javascript:;" class="disabled-link">
                <i class="fa fa-angle-right"></i>
              </a>
            </li>
            {% endif %}
          </ul>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block page_external_script %}
<script src="{{ url_for('static', filename='course/script/takeCourse.js') }}" type="text/javascript"></script>
{% endblock %}

{% block page_internal_script %}
<script type="text/javascript">
  jQuery(document).ready(function() {
    takeCourse.setActionUrl('/course/take/');
  });
</script>
{% endblock %}
